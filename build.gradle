plugins {
  id 'org.jetbrains.kotlin.multiplatform' version '1.9.0'
}

group = 'me.local'
version = '1.0-SNAPSHOT'

repositories {
  mavenCentral()
}

kotlin {
  def hostOs = System.getProperty("os.name")
  def isMingwX64 = hostOs.startsWith("Windows")
  def nativeTarget

  if (hostOs == "Mac OS X") nativeTarget = macosX64('native')
  else if (hostOs == "Linux") nativeTarget = linuxX64("native")
  else if (isMingwX64) nativeTarget = mingwX64("native")
  else throw new GradleException("Host OS is not supported in Kotlin/Native.")

  nativeTarget.binaries {
    sharedLib {
      baseName = "native"
    }
  }

  nativeTarget.compilations.main.cinterops {
    db
  }

  sourceSets {
    commonMain {

    }
    commonTest {
      dependencies {
        implementation kotlin('test')
      }
    }
    nativeMain {

    }
    nativeTest {

    }
  }
}